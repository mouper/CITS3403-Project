{% extends "base.html" %}

{% block content %}
<div class="dashboard-container">
  <div>
    <h1 class="title2">My Requests</h1>
  </div>
  <div>
    <p class="medium4">Incoming</p>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flashes">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div>
    {% for req in incoming %}
      <div class="request-card-container">
        <div class="request-card">
          <div class="request-content">
            <div class="request-info">
              <h2 class="headline tournament-name">{{ req.sender.display_name }}</h2>
              <p class="regular3 requestor-name">Requestor: {{ req.sender.username }}</p>
              <div class="info-container">
                <p class="caption">{{ req.accepted }}/{{ req.total }} Competitors Accepted</p>
                <div class="game-details">
                  <span class="regular3">{{ req.game_name }} Game Name </span>
                  <span class="regular3">{{ req.type_name }} Type Name </span>
                </div>
              </div>
            </div>
            <div class="request-image">
              <img
                src="{{ url_for('static', filename=req.sender.avatar_path or 'avatars/default.png') }}"
                alt="{{ req.sender.display_name }}â€™s avatar"
              />
            </div>
          </div>
          <div class="action-row">
            <div class="Dialog">
              <form action="{{ url_for('respond_request', invite_id=req.user_id) }}"
                    method="POST">
                <button class="cancel">Decline</button>
                <button class="accept">Accept</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      <p class="caption">You have no incoming requests.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
